<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.4: http://docutils.sourceforge.net/" />
<title>The Egg Function Library</title>
<meta name="author" content="MB" />
<style type="text/css">

@import "http://p-stade.sourceforge.net/doc/boost.css";
@import "http://p-stade.sourceforge.net/doc/poost.css";

</style>
</head>
<body>
<div class="document" id="the-egg-function-library">
<h1 class="title">The Egg Function Library</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>MB</td></tr>
<tr><th class="docinfo-name">Contact:</th>
<td><a class="first last reference" href="mailto:mb2act&#64;yahoo.co.jp">mb2act&#64;yahoo.co.jp</a></td></tr>
<tr class="field"><th class="docinfo-name">License:</th><td class="field-body">Distributed under the <a class="reference" href="http://www.boost.org/LICENSE_1_0.txt">Boost Software License Version 1.0</a></td>
</tr>
<tr><th class="docinfo-name">Version:</th>
<td>0.90.3</td></tr>
</tbody>
</table>
<blockquote class="epigraph">
<p>&quot;<em>I'm a little bird that has broken out of the egg.</em>&quot;</p>
<p class="attribution">&mdash;Peter Pan</p>
</blockquote>
<div class="contents topic">
<p class="topic-title first"><a id="table-of-contents" name="table-of-contents"><strong>Table of Contents</strong></a></p>
<ul class="auto-toc simple">
<li><a class="reference" href="#introduction" id="id6" name="id6">1&nbsp;&nbsp;&nbsp;Introduction</a></li>
<li><a class="reference" href="#requirements" id="id7" name="id7">2&nbsp;&nbsp;&nbsp;Requirements</a></li>
<li><a class="reference" href="#tested-under" id="id8" name="id8">3&nbsp;&nbsp;&nbsp;Tested Under</a></li>
<li><a class="reference" href="#quick-start" id="id9" name="id9">4&nbsp;&nbsp;&nbsp;Quick Start</a></li>
<li><a class="reference" href="#basic-concepts" id="id10" name="id10">5&nbsp;&nbsp;&nbsp;Basic Concepts</a><ul class="auto-toc">
<li><a class="reference" href="#specification" id="id11" name="id11">5.1&nbsp;&nbsp;&nbsp;Specification</a></li>
<li><a class="reference" href="#baby-function" id="id12" name="id12">5.2&nbsp;&nbsp;&nbsp;Baby Function</a></li>
</ul>
</li>
<li><a class="reference" href="#reference" id="id13" name="id13">6&nbsp;&nbsp;&nbsp;Reference</a><ul class="auto-toc">
<li><a class="reference" href="#function" id="id14" name="id14">6.1&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">function</span></tt></a></li>
<li><a class="reference" href="#pstade-egg-function" id="id15" name="id15">6.2&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">PSTADE_EGG_FUNCTION</span></tt></a></li>
<li><a class="reference" href="#pstade-egg-pipable" id="id16" name="id16">6.3&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">PSTADE_EGG_PIPABLE</span></tt></a></li>
<li><a class="reference" href="#pstade-egg-max-arity" id="id17" name="id17">6.4&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">PSTADE_EGG_MAX_ARITY</span></tt></a></li>
</ul>
</li>
<li><a class="reference" href="#acknowledgments" id="id18" name="id18">7&nbsp;&nbsp;&nbsp;Acknowledgments</a></li>
<li><a class="reference" href="#release-notes" id="id19" name="id19">8&nbsp;&nbsp;&nbsp;Release Notes</a><ul class="auto-toc">
<li><a class="reference" href="#version-0-90-0" id="id20" name="id20">8.1&nbsp;&nbsp;&nbsp;Version 0.90.0</a></li>
<li><a class="reference" href="#version-0-90-1" id="id21" name="id21">8.2&nbsp;&nbsp;&nbsp;Version 0.90.1</a></li>
<li><a class="reference" href="#version-0-90-2" id="id22" name="id22">8.3&nbsp;&nbsp;&nbsp;Version 0.90.2</a></li>
<li><a class="reference" href="#version-0-90-3" id="id23" name="id23">8.4&nbsp;&nbsp;&nbsp;Version 0.90.3</a></li>
</ul>
</li>
</ul>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id6" id="introduction" name="introduction">1&nbsp;&nbsp;&nbsp;Introduction</a></h1>
<p>Egg provides the simple way of making a <a class="reference" href="http://www.sgi.com/tech/stl/functors.html">Functor</a> that supports <a class="reference" href="http://www.boost.org/libs/utility/utility.htm#result_of">Boost.ResultOf</a> and works around
<a class="reference" href="http://std.dkuug.dk/jtc1/sc22/wg21/docs/papers/2002/n1385.htm">the Forwarding Problem</a>. All the types, functions and macros are defined in namespace <tt class="docutils literal"><span class="pre">pstade::egg</span></tt>.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id7" id="requirements" name="requirements">2&nbsp;&nbsp;&nbsp;Requirements</a></h1>
<ul class="simple">
<li><a class="reference" href="http://www.boost.org/">Boost C++ Libraries Version 1.33.1</a> or later (no compilation required)</li>
<li><a class="reference" href="http://sourceforge.net/project/showfiles.php?group_id=141222&amp;package_id=173059">P-Stade C++ Libraries Version 1.00.8</a> or later (no compilation required, give a higher priority than Boost headers)</li>
</ul>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id8" id="tested-under" name="tested-under">3&nbsp;&nbsp;&nbsp;Tested Under</a></h1>
<ul class="simple">
<li>Microsoft Visual C++ 2005 Express Edition</li>
<li>Microsoft Visual C++ .NET Version 7.1</li>
<li>GCC 3.4.4</li>
</ul>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id9" id="quick-start" name="quick-start">4&nbsp;&nbsp;&nbsp;Quick Start</a></h1>
<ol class="arabic">
<li><p class="first">Define a type that is a model of <a class="reference" href="#baby-function">Baby Function</a>:</p>
<pre class="cpp_source">
<span class="cpp_keyword">struct </span>baby_multiply
{
    <span class="cpp_keyword">template</span>&lt; <span class="cpp_keyword">class </span>Myself, <span class="cpp_keyword">class </span>X, <span class="cpp_keyword">class </span>Y &gt;
    <span class="cpp_keyword">struct </span>apply :
        boost::remove_const&lt;X&gt;
    { };


    <span class="cpp_keyword">template</span>&lt; <span class="cpp_keyword">class </span>Result, <span class="cpp_keyword">class </span>X, <span class="cpp_keyword">class </span>Y &gt;
    Result call(X&amp; x, Y&amp; y)
    {
        <span class="cpp_keyword">return </span>x * y;
    }
};</pre>

</li>
<li><p class="first">Make a functor by using <tt class="docutils literal"><span class="pre">PSTADE_EGG_FUNCTION</span></tt>:</p>
<pre class="cpp_source">
PSTADE_EGG_FUNCTION(multiply, baby_multiply)
</pre>

</li>
<li><p class="first">Use as a normal function which supports <a class="reference" href="http://www.boost.org/libs/utility/utility.htm#result_of">Boost.ResultOf</a>:</p>
<pre class="cpp_source">
<span class="cpp_keyword">void </span>test()
{
    <span class="cpp_keyword">int </span>y = <span class="cpp_number_literal">5</span>;

    boost::result_of&lt; ::multiply_fun(<span class="cpp_keyword">int</span>, <span class="cpp_keyword">int</span>) &gt;::type
        result = ::multiply(<span class="cpp_number_literal">3</span>, y);

    BOOST_CHECK( result == <span class="cpp_number_literal">15 </span>);
}</pre>

</li>
</ol>
<p>Note that <tt class="docutils literal"><span class="pre">X</span></tt> is deduced as <tt class="docutils literal"><span class="pre">int</span> <span class="pre">const</span></tt> and <tt class="docutils literal"><span class="pre">Y</span></tt> as <tt class="docutils literal"><span class="pre">int</span></tt>.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id10" id="basic-concepts" name="basic-concepts">5&nbsp;&nbsp;&nbsp;Basic Concepts</a></h1>
<div class="section">
<h2><a class="toc-backref" href="#id11" id="specification" name="specification">5.1&nbsp;&nbsp;&nbsp;Specification</a></h2>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">BabyFunction</span></tt>: a model of <a class="reference" href="#baby-function">Baby Function</a></li>
<li><tt class="docutils literal"><span class="pre">baby</span></tt>: an object of <a class="reference" href="#baby-function">Baby Function</a></li>
</ul>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id12" id="baby-function" name="baby-function">5.2&nbsp;&nbsp;&nbsp;Baby Function</a></h2>
<p>A <tt class="docutils literal"><span class="pre">BabyFunction</span></tt> is any type that is copy-constructible and the following expression must be valid.</p>
<ul class="simple">
<li>Case of no arguments; <tt class="docutils literal"><span class="pre">BabyFunction::nullary_result_type</span></tt> and <tt class="docutils literal"><span class="pre">baby.call&lt;R&gt;();</span></tt>, where <tt class="docutils literal"><span class="pre">R</span></tt> is the same as <tt class="docutils literal"><span class="pre">BabyFunction::nullary_result_type</span></tt></li>
<li>Case of <tt class="docutils literal"><span class="pre">N</span> <span class="pre">&gt;=</span> <span class="pre">1</span></tt> arguments; <tt class="docutils literal"><span class="pre">BabyFunction::apply&lt;BabyFunction,A1,A2,...,AN&gt;::type</span></tt>  and <tt class="docutils literal"><span class="pre">baby.call&lt;R&gt;(a1,a2,...aN);</span></tt>, where <tt class="docutils literal"><span class="pre">R</span></tt> is the same as <tt class="docutils literal"><span class="pre">BabyFunction::apply&lt;BabyFunction,A1,A2,...,AN&gt;::type</span></tt></li>
<li>Semantics: The nested <tt class="docutils literal"><span class="pre">nullary_result_type</span></tt> and <tt class="docutils literal"><span class="pre">result</span></tt> return the result type of the functor.</li>
</ul>
<p>Note that the result type of nullary functors is always specified by using nested <tt class="docutils literal"><span class="pre">nullary_result_type</span></tt> typedef instead of nested <tt class="docutils literal"><span class="pre">result</span></tt> templates.</p>
</div>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id13" id="reference" name="reference">6&nbsp;&nbsp;&nbsp;Reference</a></h1>
<div class="section">
<h2><a class="toc-backref" href="#id14" id="function" name="function">6.1&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">function</span></tt></a></h2>
<ul class="simple">
<li>Header: <tt class="docutils literal"><span class="pre">&lt;pstade/egg/function.hpp&gt;</span></tt></li>
<li>Valid expression: <tt class="docutils literal"><span class="pre">function&lt;BabyFunction&gt;</span> <span class="pre">fun(baby);</span></tt> or <tt class="docutils literal"><span class="pre">function&lt;BabyFunction&gt;</span> <span class="pre">fun;</span></tt></li>
<li>Precondition: The type of <tt class="docutils literal"><span class="pre">baby</span></tt> is <tt class="docutils literal"><span class="pre">BabyFunction</span></tt>. <tt class="docutils literal"><span class="pre">BabyFunction</span></tt> must be <a class="reference" href="http://www.sgi.com/tech/stl/DefaultConstructible.html">Default Constructible</a> for the latter valid expression.</li>
<li>Returns: A <a class="reference" href="http://www.sgi.com/tech/stl/functors.html">Functor</a> that supports <a class="reference" href="http://www.boost.org/libs/utility/utility.htm#result_of">Boost.ResultOf</a>.</li>
</ul>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id15" id="pstade-egg-function" name="pstade-egg-function">6.2&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">PSTADE_EGG_FUNCTION</span></tt></a></h2>
<p>There are some pitfalls when you define a <a class="reference" href="#function">function</a> under namespace scope.
So you should prefer this macro.</p>
<ul class="simple">
<li>Header: <tt class="docutils literal"><span class="pre">&lt;pstade/egg/function.hpp&gt;</span></tt></li>
<li>Valid expression: <tt class="docutils literal"><span class="pre">PSTADE_EGG_FUNCTION(Name,</span> <span class="pre">BabyFunction)</span></tt></li>
<li>Precondition: placed under namespace scope and <tt class="docutils literal"><span class="pre">BabyFunction</span></tt> is <a class="reference" href="http://www.sgi.com/tech/stl/DefaultConstructible.html">Default Constructible</a>.</li>
<li>Effects: <tt class="docutils literal"><span class="pre">typedef</span> <span class="pre">function&lt;BabyFunction&gt;</span> <span class="pre">Name##_fun;</span> <span class="pre">function&lt;BabyFunction&gt;</span> <span class="pre">const</span> <span class="pre">Name;</span></tt></li>
</ul>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id16" id="pstade-egg-pipable" name="pstade-egg-pipable">6.3&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">PSTADE_EGG_PIPABLE</span></tt></a></h2>
<ul class="simple">
<li>Header: <tt class="docutils literal"><span class="pre">&lt;pstade/egg/pipable.hpp&gt;</span></tt></li>
<li>Valid expression: <tt class="docutils literal"><span class="pre">PSTADE_EGG_PIPBLE(Name,</span> <span class="pre">BabyFunction)</span></tt></li>
<li>Precondition: same as <tt class="docutils literal"><span class="pre">PSTADE_EGG_FUNCTION</span></tt>'s</li>
<li>Effects: Makes <tt class="docutils literal"><span class="pre">in|Name(a0,a1,...aN)</span></tt> call <tt class="docutils literal"><span class="pre">function&lt;BabyFunction&gt;()(in,a0,a1,...aN)</span></tt>.</li>
</ul>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id17" id="pstade-egg-max-arity" name="pstade-egg-max-arity">6.4&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">PSTADE_EGG_MAX_ARITY</span></tt></a></h2>
<p>The default maximum arity of functors Egg makes is five. If you want more arity, define <tt class="docutils literal"><span class="pre">PSTADE_EGG_MAX_ARITY</span></tt> before
any Egg headers. Note that compilers require an exponentially increasing amount of time
as the number increases.</p>
</div>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id18" id="acknowledgments" name="acknowledgments">7&nbsp;&nbsp;&nbsp;Acknowledgments</a></h1>
<ul class="simple">
<li><a class="reference" href="http://p-stade.sourceforge.net/">P-Stade</a></li>
<li><a class="reference" href="http://www.boost.org/">Boost C++ Libraries</a></li>
</ul>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id19" id="release-notes" name="release-notes">8&nbsp;&nbsp;&nbsp;Release Notes</a></h1>
<div class="section">
<h2><a class="toc-backref" href="#id20" id="version-0-90-0" name="version-0-90-0">8.1&nbsp;&nbsp;&nbsp;Version 0.90.0</a></h2>
<ul class="simple">
<li>Released initial version.</li>
</ul>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id21" id="version-0-90-1" name="version-0-90-1">8.2&nbsp;&nbsp;&nbsp;Version 0.90.1</a></h2>
<ul class="simple">
<li>Added <tt class="docutils literal"><span class="pre">PSTADE_EGG_PIPABLE</span></tt>.</li>
</ul>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id22" id="version-0-90-2" name="version-0-90-2">8.3&nbsp;&nbsp;&nbsp;Version 0.90.2</a></h2>
<ul class="simple">
<li>Now <a class="reference" href="#baby-function">Baby Function</a> can have members.</li>
</ul>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id23" id="version-0-90-3" name="version-0-90-3">8.4&nbsp;&nbsp;&nbsp;Version 0.90.3</a></h2>
<ul class="simple">
<li>Fixed a bug that passes an <tt class="docutils literal"><span class="pre">egg::function</span></tt> object to <tt class="docutils literal"><span class="pre">BabyFunction</span></tt>'s constructor.</li>
<li>Renamed <tt class="docutils literal"><span class="pre">decay_function</span></tt> to <tt class="docutils literal"><span class="pre">pstade::pass_by_value</span></tt>.</li>
<li>Changed <tt class="docutils literal"><span class="pre">BabyFunction</span></tt>'s nested <tt class="docutils literal"><span class="pre">result</span></tt> to <tt class="docutils literal"><span class="pre">apply</span></tt>.</li>
</ul>
</div>
</div>
</div>
<div class="footer">
<hr class="footer" />
<a class="reference" href="doc/index.rst">View document source</a>.
Generated on: 2006-09-30 02:35 UTC.
Generated by <a class="reference" href="http://docutils.sourceforge.net/">Docutils</a> from <a class="reference" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> source.

</div>
</body>
</html>
